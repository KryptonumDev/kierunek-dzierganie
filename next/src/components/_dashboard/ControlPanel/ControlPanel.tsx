'use client';
import Link from 'next/link';
import { usePathname } from 'next/navigation';
import styles from './ControlPanel.module.scss';
import { createClient } from '@/utils/supabase-client';

const links = [
  {
    name: 'Moje kursy',
    href: '/moje-konto/kursy',
  },
  {
    name: 'Historia zakupów',
    href: '/moje-konto/zakupy',
  },
  {
    name: 'Pliki do pobrania',
    href: '/moje-konto/pliki-do-pobrania',
  },
  {
    name: 'Moje dane',
    href: '/moje-konto/dane',
  },
  {
    name: 'Program lojalnościowy',
    href: '/moje-konto/program-lojalnosciowy',
  },
  {
    name: 'Pomoc',
    href: '/moje-konto/pomoc',
  },
];

const ControlPanel = () => {
  const pathname = usePathname();
  const isCurrentPage = (href: string) => pathname.includes(href);
  const supabase = createClient();

  const logOut = async () => {
    await supabase.auth.signOut();
    window.location.href = '/moje-konto/wylogowano';
  };

  return (
    <section className={styles['ControlPanel']}>
      <ul>
        {links.map(({ href, name }, index) => (
          <li key={index}>
            <Link
              href={href}
              aria-current={isCurrentPage(href)}
            >
              <CurrentPageIcon />
              <span>{name}</span>
            </Link>
          </li>
        ))}
        <li className={styles.logout}>
          <button
            onClick={logOut}
            className='link'
          >
            Wyloguj się
          </button>
        </li>
      </ul>
    </section>
  );
};

export default ControlPanel;

const CurrentPageIcon = ({ ...props }) => (
  <svg
    xmlns='http://www.w3.org/2000/svg'
    width={21}
    height={16}
    fill='none'
    {...props}
  >
    <path
      d='M5.97 5.994a.375.375 0 0 0-.676-.326l.676.326ZM.875 7.718a.375.375 0 1 0-.75 0h.75Zm11.498.266a.375.375 0 0 0 .158-.733l-.158.733Zm2.726-2.4.115.357-.115-.356Zm-5.612 0 .356.118-.356-.117Zm10.77 2.41-.364-.095.363.095ZM8.196 10.78l.195-.321-.195.32ZM13.203.616l-.069.368.069-.368Zm0 13.326-.087-.365.087.365Zm-1.138-9.336-.01-.375.01.375Zm8.191 6.55-.353-.125-.003.008-.003.009.36.108ZM8.728 14.318l-.176.33.176-.33Zm-3.434-8.65c-.73 1.515-1.392 2.37-1.95 2.818-.543.437-.971.475-1.293.388-.346-.093-.646-.351-.87-.64a2.342 2.342 0 0 1-.245-.39 1.118 1.118 0 0 1-.055-.13c-.014-.041-.006-.033-.006.004h-.75c0 .088.025.175.045.233.022.069.054.144.092.222.076.155.186.337.326.519.276.357.702.754 1.269.907.59.158 1.26.031 1.957-.528.682-.548 1.404-1.517 2.156-3.077l-.676-.326Zm7.237 1.583a.696.696 0 0 1-.212-.072c-.022-.014.02.005.032.074.012.063-.016.088.006.054a.805.805 0 0 1 .17-.168c.4-.319 1.297-.748 2.688-1.198l-.232-.713c-1.4.453-2.409.915-2.923 1.324a1.521 1.521 0 0 0-.331.345.674.674 0 0 0-.115.492c.037.2.168.337.302.422.13.083.29.137.457.173l.158-.733Zm2.683-1.31c.305-.098.508-.095.633-.058.114.033.192.1.247.207.124.247.126.722-.112 1.312-.465 1.154-1.707 2.4-3.53 2.4v.75c2.197 0 3.674-1.502 4.225-2.87.27-.67.354-1.4.086-1.93a1.13 1.13 0 0 0-.707-.59c-.316-.091-.68-.061-1.073.066l.231.713Zm-2.762 3.861c-.97 0-1.897-.173-2.44-.718-.508-.51-.796-1.48-.17-3.382l-.712-.235c-.662 2.012-.453 3.34.35 4.147.77.772 1.971.938 2.972.938v-.75Zm-2.61-4.1a5.14 5.14 0 0 1 .268-.656l-.674-.33a5.892 5.892 0 0 0-.306.751l.713.235Zm.268-.656c1.136-2.318 3.835-3.21 6.185-2.762l.14-.737c-2.585-.492-5.675.468-6.999 3.169l.674.33Zm6.185-2.762c.577.11 1.125.3 1.616.565l.356-.66a6.359 6.359 0 0 0-1.832-.642l-.14.737Zm1.616.565c.813.44 1.465 1.085 1.836 1.915.37.828.475 1.872.146 3.135l.726.19c.366-1.405.262-2.626-.187-3.631-.449-1.003-1.228-1.762-2.165-2.268l-.356.66Zm1.982 5.05-.031.12.723.198.034-.129-.726-.189Zm-.031.12c-.367 1.336-.946 2.275-1.641 2.923-.696.647-1.527 1.021-2.424 1.196l.143.736c1.012-.197 1.978-.625 2.792-1.383.813-.758 1.456-1.827 1.853-3.274l-.723-.199Zm-4.065 4.119c-1.317.256-2.77.081-4.106-.287-1.334-.368-2.523-.921-3.3-1.392l-.388.641c.834.506 2.087 1.087 3.489 1.474 1.4.386 2.977.586 4.448.3l-.143-.736Zm-7.405-1.68c-.34-.205-.673-.594-.955-1.14-.28-.54-.495-1.208-.618-1.936l-.74.124c.134.792.371 1.537.692 2.157.318.615.732 1.134 1.232 1.437l.389-.641ZM6.819 7.383c-.159-.948-.155-1.98.064-2.935l-.731-.168c-.244 1.064-.246 2.195-.072 3.227l.74-.124Zm.064-2.935c.268-1.173.852-2.21 1.831-2.867.976-.656 2.4-.972 4.42-.596l.138-.737c-2.16-.402-3.796-.083-4.976.71-1.177.791-1.846 2.017-2.144 3.322l.73.168ZM13.134.984c.972.181 1.78.48 2.443.862l.375-.65c-.746-.43-1.636-.755-2.68-.949l-.138.737Zm2.443.862c.2.116.389.24.564.37l.448-.6a6.469 6.469 0 0 0-.637-.42l-.375.65Zm.564.37c1.3.971 1.932 2.347 2.04 3.827l.748-.054c-.122-1.666-.841-3.256-2.34-4.374l-.448.601Zm2.04 3.827c.162 2.227-.865 4.665-2.563 6.183l.5.56c1.863-1.666 2.991-4.327 2.81-6.797l-.747.054Zm-2.563 6.183c-.732.655-1.58 1.131-2.502 1.35l.174.73c1.06-.252 2.017-.796 2.828-1.52l-.5-.56Zm-2.502 1.35c-1.733.414-3.53-.363-4.802-1.656-1.28-1.301-1.923-3.014-1.506-4.365l-.717-.221c-.53 1.717.305 3.706 1.688 5.112 1.392 1.415 3.445 2.353 5.51 1.86l-.173-.73ZM6.808 7.556c.302-.979 1.19-1.874 3.05-2.31l-.17-.73C7.65 4.993 6.493 6.03 6.09 7.334l.717.22Zm3.05-2.31c.628-.146 1.363-.24 2.218-.264l-.021-.75c-.897.026-1.683.124-2.368.284l.171.73Zm2.218-.264c3.108-.09 5.066.505 6.264 1.342l.43-.614c-1.376-.963-3.514-1.57-6.715-1.478l.021.75Zm6.264 1.342c.802.561 1.276 1.24 1.532 1.926l.703-.262c-.308-.827-.877-1.629-1.805-2.278l-.43.614Zm1.532 1.926a4.197 4.197 0 0 1 .03 2.782l.708.249a4.947 4.947 0 0 0-.035-3.293l-.703.262Zm.025 2.799c-.28.933-1.483 2.497-3.413 3.412-1.901.9-4.5 1.165-7.58-.473l-.352.662c3.292 1.751 6.14 1.49 8.253.488 2.083-.987 3.458-2.699 3.81-3.874l-.718-.215ZM8.904 13.987C6.733 12.83 5.672 11.203 5.41 9.529c-.263-1.687.276-3.472 1.404-4.937l-.594-.458c-1.232 1.6-1.85 3.588-1.55 5.51.301 1.934 1.526 3.751 3.882 5.005l.352-.662Zm-2.09-9.395c1.807-2.346 5.09-3.829 8.843-2.711l.214-.72c-4.073-1.212-7.67.401-9.651 2.973l.594.458Zm8.843-2.711c.732.217 1.483.534 2.248.965l.368-.653a11.686 11.686 0 0 0-2.402-1.031l-.214.719Zm2.248.965c.083.047.166.095.25.145l.383-.645a13.248 13.248 0 0 0-.265-.153l-.368.653Z'
      fill='#9A827A'
    />
  </svg>
);
